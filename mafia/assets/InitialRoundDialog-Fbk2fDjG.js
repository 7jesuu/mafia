import{L as X,r as _,a as t,q as Y,O as q,P as A,Q as n,R as s,am as z,al as G,T as r,V as I,S as i,t as E,$ as w,a1 as k,aX as J,W as Z,a0 as ee,aY as ae}from"./index-CbP_1Fhm.js";import{a as se,Q as C}from"./QTabPanels-DxpV_yec.js";import{P as o,U as le,s as te,_ as oe}from"./_plugin-vue_export-helper-B_5_feRC.js";import{u as re}from"./vue-i18n-zD01oK_J.js";import{u as x}from"./use-dialog-plugin-component-CBLKhCFZ.js";import{_ as b}from"./ParticipantList.vue_vue_type_script_setup_true_lang-FU-Y7NQS.js";import"./QList-6wUb88Xh.js";import"./Player.Utilities-U37_xOdV.js";import"./PlayerRoleIcon-BgLKzmIN.js";const ne={class:"col"},ie={class:"text-subtitle1"},ue={class:"col-auto"},ce={class:"col-auto text-caption q-pa-sm"},de={class:"col fit"},pe={class:"col-auto text-caption q-pa-sm"},me={class:"col fit"},ve={class:"col-auto text-caption q-pa-sm"},fe={class:"col fit"},Pe={class:"col-auto text-caption q-pa-sm"},he={class:"col fit"},ge=X({__name:"InitialRoundDialog",props:{participants:{type:Array,required:!0},unsetRoles:{type:Array,required:!1,default:()=>[]}},emits:[...x.emits],setup(Q){const c=Q,{dialogRef:B,onDialogOK:D,onDialogHide:U}=x(),{t:d}=re({}),p=_([]),m=_([]),R=_([]),f=_([]),l=_("mafia"),P=t(()=>c.unsetRoles.includes(o.Mafia)),h=t(()=>c.unsetRoles.includes(o.Murderer)),S=t(()=>c.unsetRoles.includes(o.Poisoner)),g=t(()=>c.unsetRoles.includes(o.Psycho)),T=t(()=>c.participants.filter(a=>a.Role==o.Civilian)),N=t(()=>{const a=p.value.map(e=>e.Id);return c.participants.filter(e=>!a.includes(e.Id)&&e.Role==o.Civilian)}),F=t(()=>{const a=[...p.value,...m.value].map(e=>e.Id);return c.participants.filter(e=>!a.includes(e.Id)&&e.Role==o.Civilian)}),L=t(()=>{const a=[...p.value,...m.value,...f.value].map(e=>e.Id);return c.participants.filter(e=>!a.includes(e.Id)&&e.Role==o.Civilian)}),M=t(()=>{switch(l.value){case"murderers":return P.value;case"poisoners":return P.value||h.value||g.value;case"psychos":return h.value||P.value}return!1}),H=t(()=>{switch(l.value){case"mafia":return p.value.length>0;case"murderers":return m.value.length>0;case"poisoners":return!1;case"psychos":return f.value.length>0}return!1}),V=t(()=>{let a="mafia";return h.value&&(a="murderers"),g.value&&(a="psychos"),S.value&&(a="poisoners"),l.value==a}),O=t(()=>(!P.value||p.value.length>0)&&(!h.value||m.value.length>0)&&(!g.value||f.value.length>0)&&(!S.value||R.value.length>0)),{ButtonStyle:$}=le();function y(a){switch(a){case"mafia":P.value&&(l.value="mafia");return;case"murderers":if(!h.value){y("mafia");return}l.value="murderers";return;case"psychos":if(!g.value){y("murderers");return}l.value="psychos";return}}function v(a){switch(a){case"mafia":if(!P.value){v("murderers");return}l.value="mafia";return;case"murderers":if(!h.value){v("psychos");return}l.value="murderers";return;case"psychos":if(!g.value){v("poisoners");return}l.value="psychos";return;case"poisoners":S.value&&(l.value="poisoners");return}}function j(){switch(l.value){case"murderers":y("mafia");return;case"psychos":y("murderers");return;case"poisoners":y("psychos");return}}function K(){switch(l.value){case"mafia":v("murderers");return;case"murderers":v("psychos");return;case"psychos":v("poisoners");return}}function W(){D({MafiaRoles:p.value.map(a=>({Id:a.Id,Role:o.Mafia})),MurdererRoles:m.value.map(a=>({Id:a.Id,Role:o.Murderer})),PsychoRoles:f.value.map(a=>({Id:a.Id,Role:o.Psycho})),PoisonerRoles:R.value.map(a=>({Id:a.Id,Role:o.Poisoner}))})}return Y(()=>{v("mafia")}),(a,e)=>(q(),A(ae,{ref_key:"dialogRef",ref:B,onHide:e[7]||(e[7]=()=>i(U)()),persistent:""},{default:n(()=>[s(z,{class:"q-dialog-plugin dialog-card column no-wrap","non-square":""},{default:n(()=>[s(G,{class:"col-auto row items-center justify-between"},{default:n(()=>[r("div",ne,[r("div",ie,I(i(d)("Game.SetInitialRoles")),1)]),r("div",ue,[E(s(w,{icon:"s_close",round:"",flat:""},null,512),[[te]])])]),_:1}),s(k),s(G,{class:"col grid scroll fit q-pa-none"},{default:n(()=>[s(se,{modelValue:l.value,"onUpdate:modelValue":e[4]||(e[4]=u=>l.value=u),class:"fit","keep-alive":"",animated:""},{default:n(()=>[s(C,{class:"column fit no-wrap q-pa-none",name:"mafia"},{default:n(()=>[r("div",ce,I(i(d)("Game.MafiaParticipantsSelectCaption")),1),s(k),r("div",de,[s(b,{class:"fit scroll",modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=u=>p.value=u),items:T.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1}),s(C,{class:"column fit no-wrap q-pa-none",name:"murderers"},{default:n(()=>[r("div",pe,I(i(d)("Game.MurdererParticipantsSelectCaption")),1),r("div",me,[s(b,{class:"fit scroll",modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=u=>m.value=u),items:N.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1}),s(C,{class:"column fit no-wrap q-pa-none",name:"psychos"},{default:n(()=>[r("div",ve,I(i(d)("Game.PsychoParticipantsSelectCaption")),1),r("div",fe,[s(b,{class:"fit scroll",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=u=>f.value=u),items:F.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1}),s(C,{class:"column fit no-wrap q-pa-none",name:"poisoners"},{default:n(()=>[r("div",Pe,I(i(d)("Game.PoisonerParticipantsSelectCaption")),1),r("div",he,[s(b,{class:"fit scroll",modelValue:R.value,"onUpdate:modelValue":e[3]||(e[3]=u=>R.value=u),items:L.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(k),s(J,{class:"col-auto",align:"right"},{default:n(()=>[M.value?(q(),A(w,{key:0,onClick:e[5]||(e[5]=()=>j()),label:i(d)("General.Back"),disable:!M.value,color:"primary",flat:"","no-caps":""},null,8,["label","disable"])):Z("",!0),s(w,ee({onClick:e[6]||(e[6]=()=>V.value?W():K()),label:V.value?i(d)("General.Accept"):i(d)("General.Next"),disable:V.value?!O.value:!H.value},i($),{color:"primary","no-caps":""}),null,16,["label","disable"])]),_:1})]),_:1})]),_:1},512))}}),ke=oe(ge,[["__scopeId","data-v-f336936d"]]);export{ke as default};
