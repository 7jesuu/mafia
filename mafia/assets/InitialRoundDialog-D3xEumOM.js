import{L as j,r as g,a as t,q as K,O as M,P as k,Q as o,R as s,am as W,al as G,T as r,V as h,S as i,t as X,$ as I,a1 as b,aX as Y,W as z,a0 as E,aY as J}from"./index-mZFDmhnv.js";import{a as Z,Q as S}from"./QTabPanels-DtneUSqx.js";import{P as n,U as ee,s as ae,_ as se}from"./_plugin-vue_export-helper-VXAAOWQH.js";import{u as le}from"./vue-i18n-BYz-iA8F.js";import{u as q}from"./use-dialog-plugin-component-CnvAtoGJ.js";import{_ as V}from"./ParticipantList.vue_vue_type_script_setup_true_lang-B1jpeg3E.js";import"./QList-BC2pjQWj.js";import"./Player.Utilities-BIboltz3.js";import"./PlayerRoleIcon-ApZzWwII.js";const te={class:"col"},oe={class:"text-subtitle1"},re={class:"col-auto"},ie={class:"col-auto text-caption q-pa-sm"},ne={class:"col fit"},ue={class:"col-auto text-caption q-pa-sm"},ce={class:"col fit"},de={class:"col-auto text-caption q-pa-sm"},pe={class:"col fit"},me=j({__name:"InitialRoundDialog",props:{participants:{type:Array,required:!0},unsetRoles:{type:Array,required:!1,default:()=>[]}},emits:[...q.emits],setup(A){const m=A,{dialogRef:Q,onDialogOK:x,onDialogHide:B}=q(),{t:u}=le({}),c=g([]),v=g([]),_=g([]),l=g("mafia"),d=t(()=>m.unsetRoles.includes(n.Mafia)),f=t(()=>m.unsetRoles.includes(n.Murderer)),P=t(()=>m.unsetRoles.includes(n.Psycho)),D=t(()=>m.participants.filter(e=>e.Role==n.Civilian)),T=t(()=>{const e=c.value.map(a=>a.Id);return m.participants.filter(a=>!e.includes(a.Id)&&a.Role==n.Civilian)}),U=t(()=>{const e=[...c.value,...v.value].map(a=>a.Id);return m.participants.filter(a=>!e.includes(a.Id)&&a.Role==n.Civilian)}),w=t(()=>l.value=="mafia"?!1:d.value&&l.value=="murderers"||f.value&&l.value=="psychos"),F=t(()=>l.value=="psychos"?!1:!d.value||c.value.length>0);t(()=>{let e="mafia";return d.value||(e="murderers"),f.value||(e="psychos"),l.value==e});const C=t(()=>{let e="psychos";return P.value||(e="murderers"),!f.value&&d.value&&(e="mafia"),l.value==e}),N=t(()=>(!d.value||c.value.length>0)&&(!f.value||v.value.length>0)&&(!P.value||_.value.length>0)),{ButtonStyle:L}=ee();function R(e){switch(e){case"mafia":d.value&&(l.value="mafia");return;case"murderers":if(!f.value){R("mafia");return}l.value="murderers";return}}function y(e){switch(e){case"mafia":if(!d.value){y("murderers");return}l.value="mafia";return;case"murderers":if(!f.value){y("psychos");return}l.value="murderers";return;case"psychos":P.value&&(l.value="psychos");return}}function H(){switch(l.value){case"murderers":R("mafia");return;case"psychos":R("murderers");return}}function O(){switch(l.value){case"mafia":y("murderers");return;case"murderers":y("psychos");return}}function $(){x({MafiaRoles:c.value.map(e=>({Id:e.Id,Role:n.Mafia})),MurdererRoles:v.value.map(e=>({Id:e.Id,Role:n.Murderer})),PsychoRoles:_.value.map(e=>({Id:e.Id,Role:n.Psycho}))})}return K(()=>{y("mafia")}),(e,a)=>(M(),k(J,{ref_key:"dialogRef",ref:Q,onHide:a[6]||(a[6]=()=>i(B)()),persistent:""},{default:o(()=>[s(W,{class:"q-dialog-plugin dialog-card column no-wrap","non-square":""},{default:o(()=>[s(G,{class:"col-auto row items-center justify-between"},{default:o(()=>[r("div",te,[r("div",oe,h(i(u)("Game.SetInitialRoles")),1)]),r("div",re,[X(s(I,{icon:"s_close",round:"",flat:""},null,512),[[ae]])])]),_:1}),s(b),s(G,{class:"col grid scroll fit q-pa-none"},{default:o(()=>[s(Z,{modelValue:l.value,"onUpdate:modelValue":a[3]||(a[3]=p=>l.value=p),class:"fit","keep-alive":"",animated:""},{default:o(()=>[s(S,{class:"column fit no-wrap q-pa-none",name:"mafia"},{default:o(()=>[r("div",ie,h(i(u)("Game.MafiaParticipantsSelectCaption")),1),s(b),r("div",ne,[s(V,{class:"fit scroll",modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=p=>c.value=p),items:D.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1}),s(S,{class:"column fit no-wrap q-pa-none",name:"murderers"},{default:o(()=>[r("div",ue,h(i(u)("Game.MurdererParticipantsSelectCaption")),1),r("div",ce,[s(V,{class:"fit scroll",modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=p=>v.value=p),items:T.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1}),s(S,{class:"column fit no-wrap q-pa-none",name:"psychos"},{default:o(()=>[r("div",de,h(i(u)("Game.PsychoParticipantsSelectCaption")),1),r("div",pe,[s(V,{class:"fit scroll",modelValue:_.value,"onUpdate:modelValue":a[2]||(a[2]=p=>_.value=p),items:U.value,selection:"",clickable:""},null,8,["modelValue","items"])])]),_:1})]),_:1},8,["modelValue"])]),_:1}),s(b),s(Y,{class:"col-auto",align:"right"},{default:o(()=>[w.value?(M(),k(I,{key:0,onClick:a[4]||(a[4]=()=>H()),label:i(u)("General.Back"),disable:!w.value,color:"primary",flat:"","no-caps":""},null,8,["label","disable"])):z("",!0),s(I,E({onClick:a[5]||(a[5]=()=>C.value?$():O()),label:C.value?i(u)("General.Accept"):i(u)("General.Next"),disable:C.value?!N.value:!F.value},i(L),{color:"primary","no-caps":""}),null,16,["label","disable"])]),_:1})]),_:1})]),_:1},512))}}),Ie=se(me,[["__scopeId","data-v-2d6426f1"]]);export{Ie as default};
